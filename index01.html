<html lang="es">

<head>
  <title>Leaflet taller</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="autor" />
  <meta name="description" content="descripción página">
  <meta name="robots" content="index,follow">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
  <script src="https://calvinmetcalf.github.io/leaflet-ajax/dist/leaflet.ajax.js"></script>
  <link rel="stylesheet" href="css/MarkerCluster.css">
  <link rel="stylesheet" href="css/MarkerCluster.Default.css">
  <script src="js/leaflet.markercluster-src.js"></script>
  <style>
    #mapAqui {
      height: 600px;
      background: #4c4c4c;
    }
  </style>
  <script>
    function iniciarmapa() {
      var tiles = L.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        maxZoom: 18,
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Points &copy 2012 LINZ'
      }),
        latlng = L.latLng(41.40288966232697, 2.198766893752577);

      var map = L.map('mapAqui', { center: latlng, zoom: 13, layers: [tiles] });
      var markers = L.markerClusterGroup();
            baresPoblenou2 = new L.GeoJSON.AJAX('data/farmacias.geojson', {
                maxZoom: 19,
                minZoom: 14,
                pointToLayer: function (feature, latlng) {
                    var title = feature.properties.NOM;
                    var marker = L.marker(latlng, {
                        title: title
                    });
                    marker.bindPopup(title);
                    markers.addLayer(marker);
                    return
                },
            });

            map.addLayer(markers);
      var iconDefault = L.icon({
        iconUrl: 'image/icoAzul.png'
      })
      var iconDinamic = L.icon({
        iconUrl: 'image/icoPlomo.png'
      })
      var iconDinamic2 = L.icon({
        iconUrl: 'image/icoVioleta.png'
      })
      var markers = L.markerClusterGroup();

      for (var i = 0; i < baresPoblenou.length; i++) {
        var a = baresPoblenou[i];
        var title = a[2];
        var marker = L.marker([baresPoblenou[i].lat, baresPoblenou[i].lng], { title: title });
        marker.bindPopup(title);
        markers.addLayer(marker);

        marker.on('mouseover', function () {
          this.setIcon(iconDinamic)
        });
        marker.on('mouseout', function () {
          this.setIcon(iconDefault)
        });
        marker.on('mousedown', function () {
          this.setIcon(iconDinamic2)
        });
        marker.on('mouseup', function () {
          this.setIcon(iconDefault)
        });
      }

      map.addLayer(markers);
    }

  </script>
</head>

<body onload='iniciarmapa()'>
  <div id="mapAqui"></div>
</body>

</html>